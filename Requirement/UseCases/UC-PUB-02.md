# UC-PUB-02: Xuất dự án ra Excel

<table><tbody><tr><td>ID and Name:</td><td>UC-PUB-02: Xuất dự án ra Excel</td><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>Created By:</td><td>&nbsp;</td><td>Date Created:</td><td>&nbsp;</td></tr><tr><td>Primary Actor:</td><td>Business Analyst (BA)</td><td>Secondary Actors:</td><td>&nbsp;</td></tr><tr><td>Description:</td><td colspan="3">Use case này cho phép BA xuất toàn bộ (hoặc một phần) dữ liệu dự án ra một file <code>.xlsx</code> duy nhất. Mỗi "Loại Đối tượng" (<code>@UC</code>, <code>@BR</code>...) sẽ trở thành một "Sheet" (trang tính) riêng biệt trong file Excel. Đây là chức năng ngược của <code>UC-PM-03</code> (Import từ Excel).</td></tr><tr><td>Trigger:</td><td colspan="3">BA chọn "File" > "Export" > "Export to Excel..."</td></tr><tr><td>Preconditions:</td><td colspan="3">1. BA đã mở một dự án (tham chiếu <code>UC-PM-02</code>).<br>2. Dự án có chứa các đối tượng yêu cầu (ví dụ: <code>@UC001</code>, <code>@BR005</code>...).</td></tr><tr><td>Postconditions:</td><td colspan="3"><b>Thành công:</b> Một file <code>.xlsx</code> được tạo ra trên ổ đĩa của BA, chứa dữ liệu của các đối tượng đã chọn, được tổ chức theo từng Sheet.<br><b>Thất bại:</b> Không có file nào được tạo. Hệ thống hiển thị thông báo lỗi.</td></tr><tr><td>Normal Flow:</td><td colspan="3">1.0. BA chọn "File" > "Export" > "Export to Excel...".<br>2.0. Hệ thống hiển thị cửa sổ "Tùy chọn Xuất ra Excel" (Export to Excel Options).<br>3.0. Hệ thống hiển thị một danh sách (Checklist) tất cả các "Loại Đối tượng" (Artifact Types) đã định nghĩa trong dự án (ví dụ: [x] <code>Use Case (@UC)</code>, [x] <code>Business Rule (@BR)</code>, [x] <code>Task (@TSK)</code>). Mặc định tất cả được chọn.<br>4.0. BA có thể bỏ chọn các loại mà mình không muốn xuất.<br>5.0. BA chọn vị trí lưu file và đặt tên file (ví dụ: <code>MyProject_Export.xlsx</code>).<br>6.0. BA nhấn "Export".<br>7.0. Hệ thống (Tự động hóa) bắt đầu quá trình nền:<br>    - 7.1. Tạo một file Excel (workbook) trong bộ nhớ.<br>    - 7.2. Lặp (loop) qua từng "Loại Đối tượng" (<code>@UC</code>, <code>@BR</code>...) mà BA đã chọn.<br>    - 7.3. Tạo một "Sheet" mới trong workbook với tên tương ứng (ví dụ: "Use Cases").<br>    - 7.4. Đọc file cấu hình template của loại đó (ví dụ: <code>uc.template.json</code>) để lấy danh sách tất cả các "trường" (fields) đã định nghĩa.<br>    - 7.5. Ghi các tên trường (ví dụ: "ID", "Name", "Description", "Actor") làm hàng tiêu đề (Header Row) cho Sheet.<br>    - 7.6. Quét dự án, tìm tất cả các file <code>.json</code> của loại đó (ví dụ: <code>UC001.json</code>, <code>UC002.json</code>...).<br>    - 7.7. Với mỗi file <code>.json</code>, ghi dữ liệu của nó thành một hàng (row) mới trong Sheet, ánh xạ dữ liệu vào các cột tương ứng.<br>8.0. Sau khi lặp qua tất cả các loại, hệ thống lưu file Excel (workbook) ra ổ đĩa tại vị trí BA đã chọn.<br>9.0. Hệ thống hiển thị thông báo "Xuất ra Excel thành công."</td></tr><tr><td>Alternative Flows:</td><td colspan="3">N/A</td></tr><tr><td>Exceptions:</td><td colspan="3"><b>1.0.E1: Lỗi ghi file (Write Error)</b><br>Tại bước 8.0:<br>8.1. Hệ thống không thể ghi file (ví dụ: file <code>.xlsx</code> đang được mở bởi ứng dụng khác, không có quyền ghi, ổ đĩa đầy).<br>8.2. Hệ thống hiển thị thông báo lỗi chi tiết (ví dụ: "Không thể ghi file. File có thể đang được sử dụng.")."<br>8.3. Use case kết thúc thất bại.</td></tr><tr><td>Priority:</td><td colspan="3">Trung bình</td></tr><tr><td>Frequency of Use:</td><td colspan="3">Thấp (Dùng để sao lưu, bàn giao hoặc chia sẻ với các bên liên quan không dùng ứng dụng)</td></tr><tr><td>Business Rules:</td><td colspan="3"><code>BR-EXPORT-01</code>: Dữ liệu (ví dụ: <code>Flow Builder</code>) có cấu trúc phức tạp (nested) sẽ được chuyển đổi (flattened) thành dạng text (ví dụ: JSON string) hoặc Markdown để lưu vào một ô (cell) duy nhất trong Excel.</td></tr><tr><td>Other Information:</td><td colspan="3">File Excel được xuất ra nên có cấu trúc tương thích để có thể được tái nhập (re-import) bằng <code>UC-PM-03</code>.</td></tr><tr><td>Assumptions:</td><td colspan="3">Ứng dụng đã tích hợp thư viện Java để xử lý file Excel (ví dụ: Apache POI).</td></tr></tbody></table>

## Guideline

Định danh cho luồng bình thường của use case này là 1.0. Các luồng thay thế được xác định bằng cách tăng số ở bên phải dấu chấm, vì vậy luồng thay thế đầu tiên là 1.1, luồng thứ hai sẽ là 1.2, v.v. Cả luồng bình thường và luồng thay thế đều có thể có các ngoại lệ riêng. Ngoại lệ đầu tiên trên luồng bình thường của use case số 4 sẽ được gắn nhãn 1.0.E1. Ngoại lệ thứ hai cho luồng thay thế đầu tiên của use case này sẽ là 1.1.E2.