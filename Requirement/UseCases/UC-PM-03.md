# UC-PM-03: Import dự án từ Excel

<table><tbody><tr><td>ID and Name:</td><td>UC-PM-03: Import dự án từ Excel</td><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>Created By:</td><td>&nbsp;</td><td>Date Created:</td><td>&nbsp;</td></tr><tr><td>Primary Actor:</td><td>Business Analyst (BA)</td><td>Secondary Actors:</td><td>&nbsp;</td></tr><tr><td>Description:</td><td colspan="3">Use case này cho phép BA nhanh chóng "đổ" dữ liệu từ một file SRS (dạng Excel) đã có vào một dự án RMS mới. Hệ thống sẽ đọc các sheet, các hàng và tạo ra các Đối tượng Yêu cầu (Artifacts) tương ứng.</td></tr><tr><td>Trigger:</td><td colspan="3">BA chọn "File" > "Import" > "Import from Excel..."</td></tr><tr><td>Preconditions:</td><td colspan="3">1. BA đã mở một dự án (<code>UC-PM-02</code>).<br>2. BA đã định nghĩa các "Loại Đối tượng" (ví dụ: <code>@FN</code>, <code>@ACT</code>) mà mình muốn import vào (<code>UC-CFG-01</code>).<br>3. BA có sẵn một file <code>.xlsx</code> (hoặc <code>.csv</code>) chứa dữ liệu yêu cầu.</td></tr><tr><td>Postconditions:</td><td colspan="3"><b>Thành công:</b> Các đối tượng yêu cầu (ví dụ: <code>FN001</code>, <code>FN002</code>...) được tạo hàng loạt trong dự án RMS từ dữ liệu của file Excel.<br><b>Thất bại:</b> Không có đối tượng nào được tạo. Hệ thống hiển thị thông báo lỗi.</td></tr><tr><td>Normal Flow:</td><td colspan="3">1.0. BA chọn "File" > "Import" > "Import from Excel...".<br>2.0. Hệ thống hiển thị một cửa sổ chọn file của hệ điều hành.<br>3.0. BA chọn file <code>.xlsx</code> và nhấn "Open".<br>4.0. Hệ thống đọc file và hiển thị giao diện "Import Wizard" (Trình hướng dẫn Import).<br>5.0. Giao diện hiển thị danh sách các Sheet tìm thấy trong file Excel (ví dụ: "Function list", "Actor TBU").<br>6.0. BA chọn một Sheet (ví dụ: "Function list") để ánh xạ (map).<br>7.0. BA chọn "Loại Đối tượng" (Artifact Type) trong dự án RMS mà mình muốn ánh xạ tới (ví dụ: <code>@FN: Chức năng</code>).<br>8.0. Hệ thống hiển thị giao diện ánh xạ 2 cột: Cột A là danh sách các "Cột trong Excel" (ví dụ: "Trace Code", "Chức năng", "Độ ưu tiên"); Cột B là danh sách các "Trường trong Form <code>@FN</code>" (ví dụ: "ID", "Name", "Priority").<br>9.0. BA thực hiện ánh xạ (mapping) cho các cột (ví dụ: "Trace Code" -> "ID", "Chức năng" -> "Name").<br>10.0. BA lặp lại bước 6-9 cho tất cả các Sheet mình muốn import.<br>11.0. BA nhấn nút "Start Import".<br>12.0. Hệ thống quét qua từng hàng (row) trong các Sheet đã được ánh xạ.<br>13.0. Với mỗi hàng, hệ thống tạo một Đối tượng Yêu cầu mới (ví dụ: <code>FN001.json</code>, <code>FN002.json</code>...), điền dữ liệu từ các ô (cell) vào các trường (field) tương ứng theo ánh xạ.<br>14.0. Hệ thống hiển thị thông báo "Import thành công: [X] Chức năng, [Y] Tác nhân đã được tạo."</td></tr><tr><td>Alternative Flows:</td><td colspan="3"><b>10.a. Bỏ qua Sheet:</b><br>Nếu BA không ánh xạ một Sheet, hệ thống sẽ bỏ qua tất cả dữ liệu trong Sheet đó.<br><br><b>10.b. Lưu/Tải Cấu hình Ánh xạ:</b><br>10.1. BA có thể nhấn "Save Mapping Template" để lưu lại cấu hình ánh xạ (tại bước 10) thành một file <code>.json</code> để tái sử dụng.<br>10.2. Lần sau (tại bước 8), BA có thể nhấn "Load Mapping Template" để tự động áp dụng lại cấu hình ánh xạ.</td></tr><tr><td>Exceptions:</td><td colspan="3"><b>3.0.E1: File không hợp lệ:</b><br>Hệ thống không thể đọc file (ví dụ: file bị hỏng, không phải <code>.xlsx</code>). Hệ thống hiển thị lỗi và kết thúc use case.<br><br><b>13.0.E1: Lỗi dữ liệu:</b><br>Hệ thống gặp lỗi khi tạo đối tượng (ví dụ: ID trùng lặp, dữ liệu không đúng định dạng).<br>13.1. Hệ thống ghi lại lỗi của hàng đó vào một file log.<br>13.2. Hệ thống bỏ qua hàng bị lỗi và tiếp tục với hàng tiếp theo.<br>13.3. Sau khi hoàn tất (bước 14), hệ thống thông báo "Import hoàn tất với [Z] lỗi. Vui lòng xem file log."</td></tr><tr><td>Priority:</td><td colspan="3">Trung bình</td></tr><tr><td>Frequency of Use:</td><td colspan="3">Thấp (Chủ yếu khi mới thiết lập dự án)</td></tr><tr><td>Business Rules:</td><td colspan="3"><code>BR-IMPORT-01</code>: ID (Tiền tố + Số) phải là duy nhất. Nếu ID từ file Excel đã tồn tại, hệ thống phải báo lỗi (trừ khi có chế độ "Update").</td></tr><tr><td>Other Information:</td><td colspan="3">Chức năng này giúp tiết kiệm thời gian khổng lồ cho các BA đã có sẵn tài liệu SRS dạng bảng (tabular).</td></tr><tr><td>Assumptions:</td><td colspan="3">BA đã "dọn dẹp" file Excel của mình (ví dụ: không có hàng gộp (merged cells) ở phần dữ liệu) để hệ thống đọc dễ dàng.</td></tr></tbody></table>

## Guideline

Định danh cho luồng bình thường của use case này là 1.0. Các luồng thay thế được xác định bằng cách tăng số ở bên phải dấu chấm, vì vậy luồng thay thế đầu tiên là 1.1, luồng thứ hai sẽ là 1.2, v.v. Cả luồng bình thường và luồng thay thế đều có thể có các ngoại lệ riêng. Ngoại lệ đầu tiên trên luồng bình thường của use case số 4 sẽ được gắn nhãn 1.0.E1. Ngoại lệ thứ hai cho luồng thay thế đầu tiên của use case này sẽ là 1.1.E2.